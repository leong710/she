# PPC
Particular Physical Checkup (PPC) - 特殊健康檢查

## 240814 -- 起始工程
    1. 建構權限管理介面
    2. 建構廠區清單管理：
        2-1. 添加新欄位[osha_id]
        2-2. _local功能將視實際需求進行取捨。<待調整>

    3. 建構特殊危害健康作業管理index：
        3-1. 新增篩選查詢功能。
        3-2. 新增下載Excel介面功能(根據篩選結果輸出)。
        3-3. 新增上傳Excel介面功能+上傳結果檢視和範例檔。

    4. 新增單筆新增功能 form.php，增加部門代號查詢功能：
        4-1. 同步更新api-center-hrdb的服務功能。
        4-2. 增加監聽驗證：當類別選定"噪音"時，會提示均能音量和8小時平均音壓二擇一填寫。
        4-3. 增加監聽驗證：HE_CATE/類別至少要選一項，防止空單送出錯誤。(採用判斷空陣列方式)
        4-4. 新增模式有Reset鈕，編輯模式不存在。
        4-5. submit送出給process_crud.php進行處理，內藏(check_HE_CATE)辨識部門代號+類別是否是第一筆，若是則以swal顯示提醒!

    5. 新增危害類別管理功能：
        5-1. 可以新增新[代碼][類別]
        5-2. 可以刪除舊類別
        5-3. 未設置編輯功能，防止物件錯誤，直接用5-1、5-2取代。
        5-4. 檔案輸出成JSON檔，節省資料庫資源。

## 240821
    1. 建構特危作業人員管理：
        1-1. 建構篩選階層：廠別 > 部門代號 > 取得人事資料庫(hrdb即時)。
        1-2. audit 廠別、部門代號 至少需勾選一項，才能進行查詢。
        1-3. 增加驗證(is-invalid)提醒(invalid-feedback)功能，提醒使用人勾選。
        1-4. 取得之員工資料暫時貼在p2(員工清單中)，因為資料龐大，搭配外掛function DataTable來使用，可達到分頁、排序、搜尋...等功能。
        1-5. 預留功能：單筆新增、Excel批次上傳、Excel下載功能。
        1-6. 因為員工資料取得後的作為與顯示方式需與user(惠旭)進行協調，顯示配置方式、對應功能 (8/19已提供)
        1-7. 增加一清空table(_shLocal)功能，因為權限過大，需要開通mySQL內user權限，並限制使用對象、使用時機(使用前禁止上傳或編輯)。

    extra. deBug工作：
        2-1. 圖書館-深耕 新增文件 原本-限制窗口以上；升級改版-環安同仁。
        2-2. PPE系統 廠調器材 原本收貨人需要在db中才能顯示 接收按鈕；升級改版-只要是自己轄區都可接收。

## 240828
    1. 續建特危作業人員管理：
        1.1. Excel批次上傳功能建構完成。
        1.2. Excel批次上傳後會篩出部門代碼，並以此部門代碼匯入(整併)到目前使用的特危作業清單 
        1.3. 單筆新增功能建構完成，可以工號、姓名、NT帳號進行模糊搜尋，在依查詢結果選擇帶入。
        1.4. 單筆新增後會篩出部門代碼，並以此部門代碼匯入(整併)到目前使用的特危作業清單 
        1.5. 增加單筆名單刪除功能，可剔除非必要人員。
        1.6. 增加[特作項目]修改功能，可針對之前選錯的部分進行修正。==> 有Bug，改用先前單選特危作業的方式進行覆蓋。(用覆蓋已解)
        1.7. 當選定或修正特作項目後，隨即更新該筆資料與顯示，並篩出有含噪音之項目，做資格判定(目前完成方法A+B+C)
        1.8. 增加噪音判斷公式：checkNoise，可判定出樣本A、樣本B和驗證結果

## 240905
    1. 續建特危作業人員管理：
        1.1. user要求去除到職日欄位，增加轉調欄位...轉調欄位功能尚待釐清，原到職日埋在姓名按鈕的title中。
        1.2. 增加[資格驗證]欄位，暫時顯示noise(噪音)、newOne(新進)、regular(定期)、change(變更)的驗證結果true、false。目前僅噪音顯示正常
        1.3. 特檢資格 增加 符合特檢的項目
        1.4.

## 240912
    1. 續建特危作業人員管理：
        1.1. [資格驗證]欄位，newOne(新進) 欄位已經可顯示是否為新人...(待加入辨識是否編入在特危場所的單位中)
        1.1. [資格驗證]欄位，change(變更) 比對今年和去年單位部門代碼的不同，並在轉調欄位中明顯顯示，(維獨還需要加上辨識是在[特危場所]的in或out...0912完成)
        1.2. 增加[下載]功能，已可對當年度的資料進行下載...(編輯後可上拋存檔? 不行! 因為上傳簡單，下載複雜，除非雙方表單一致...)
        1.3. 因應護理師對照需求，將姓名工號以外的欄位進行上下層分割，上層為當年度，下層有底色的為去年度。
        1.4. 因為欄位繁多，顯示上容易變形，建議使用24吋+解析度1920x1080dpi之顯示器，以利判讀。
        1.5. 補足 Excel匯入時只有健檢類別代號而其他資訊空虛的問題...

## 240919
    1. 續建特危作業人員管理：
        1.1. 升級[提取存檔員工資料]功能，由一次按一個單位，升級成多選後一次帶入。
        1.2. 改善[提取部門現況名單]執行效率，由step-2點選時產生文字串、監聽文字串變化再生成step3，升級成step-2點選時不產生文字串也不監聽，直接由step-3點擊時才去過濾step-2的勾選清單。
        1.3. 特檢資格之泡泡標籤升級成分類顏色。

## 241021
    1. owner需求修正：
        1.1. 特危作業管理由 整體刪除 => 勾選刪除 ok
        1.2. Label變更作業特殊健檢 => 定期特殊健檢 ok
        1.3. Excel上傳名單時，不自動帶入特作項目!!!
## 241023
    1. 功能優化：
        1.1. 部門代號dept_no的變更檢查進行深層比對調部門這件事，取紀錄中今年和去年的紀錄出來驗證。
        1.2. 匯入staff資料時，暫時不比對hrdb，以Excel內容為主，同一人第一筆為今年目前，第二筆為過往紀錄。
        1.3. 關閉由hrdb帶入部門人員的功能。(已自板塊中清除)
        1.4. 配合特危作業管理改成勾選刪除功能，下載功能升級成 勾選下載，未勾選則為全部下載。

## 241028
    1.
        1.1. 今年度匯入之人員名單，只要今年度待過的部門，在提取部門名單中都會出現，例如：梅爾之前在FAB6，之後到T6，提取名單時會出現在FAB6和T6中出現。(只分拆當年度)
        1.2. ** FAB6和T6的窗口不可以同時編輯，有導致儲存衝突....(這一點我還不知道該怎麼避免...)
        1.3. 原本匯入FAB6時可以挑當時FAB6的危害地圖，存檔後再提出，此時會以目前人事資料庫上的部門代號來撈危害地圖。補強提取資料後原本只抓最外層的部門代號'shCase，補上shCase_logs內當年度'shCase

# 241107
    1. Bug修復與優化：
        1.1. 事故訪談系統...asIs：所有損工項目，都需要進行職災申報。 toBe：增加判斷模組，損工職災申報排除 1.廠外交通事故、2.設備/其他事故。
        1.2. 圖書館 添加教材時無法選擇專題分類。 已修復，原因是value尾端少了結尾符號 " ，導致顯示成空值的錯誤。
        1.3. 圖書館 教材課程級別超過3以上的，導致無法閱讀的狀況。已修復，原因是開頭判斷級別分類的switch其default的尾端加上了return...移除後即恢復正常。
        1.4. tnESHip 上頭圖書館新書跑馬燈之超連結未更新到新的播放模組。已修復：連結到新的修復模組。
    2. 健檢系統：
        2.1. 取消前後單位都可提取的功能，只保留新單位可以提取及填寫暴露時間...
        2.2. 提取功能後方增加完成度(%)顯示功能，可讓使用者了解編輯進度。

# 241108
    1. 緊急聯絡電話查詢系統權限開啟，T1、T2、T3 共12人，查詢測試驗證完成，已可正常使用。
        T1：07000573黃俊繻/16023999吳聲鋐/23010993詹雅婷/24007088吳韋德
        T2：20031603卓榆豐/22007143鄭凱文/23013054林志翰/24007089陳茗祥
        T3：14062892詹珀勝/10167939徐凡茵/12095547洪聖皇/24003601陳朝志

## 軟體設計原則 KISS (Keep it simple, stupid)
